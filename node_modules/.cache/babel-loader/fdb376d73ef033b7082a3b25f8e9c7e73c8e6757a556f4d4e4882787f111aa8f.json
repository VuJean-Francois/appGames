{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import haversine from\"../haversine\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const MyShop=()=>{const[myShop,setMyShop]=useState({name:\"\",city:\"\",distance:\"\"});useEffect(()=>{// requete Ajax\nconst url=\"https://formacitron.github.io/shopslist/shops.json\";fetch(url).then(response=>response.json()).then(shops=>{console.log(shops);navigator.geolocation.getCurrentPosition(position=>{const nearest={distance:null,shop:null};console.log(position.coords.latitude,position.coords.longitude);for(const shop of shops){const a={latitude:position.coords.latitude,longitude:position.coords.longitude};const b={latitude:shop.gps_lat,longitude:shop.gps_lng};const distance=haversine(a,b);// 714504.18 (in meters)\nif(nearest.distance==null){nearest.distance=distance;nearest.shop=shop;}else{if(nearest.distance>distance){nearest.distance=distance;nearest.shop=shop;}}}setMyShop({name:nearest.shop.name,city:nearest.shop.city,distance:(nearest.distance/1000).toFixed(2)});});});},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col h-full text-center\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl text-center\",children:myShop.name}),/*#__PURE__*/_jsx(\"p\",{className:\"flex-grow\",children:myShop.city}),/*#__PURE__*/_jsxs(\"p\",{children:[myShop.distance,\" km\"]})]});};export default MyShop;","map":{"version":3,"names":["React","useEffect","useState","haversine","jsx","_jsx","jsxs","_jsxs","MyShop","myShop","setMyShop","name","city","distance","url","fetch","then","response","json","shops","console","log","navigator","geolocation","getCurrentPosition","position","nearest","shop","coords","latitude","longitude","a","b","gps_lat","gps_lng","toFixed","className","children"],"sources":["C:/Users/jean-fra.vu/Documents/React/appGames/games/src/pages/MyShop.js"],"sourcesContent":["\r\nimport React, { useEffect, useState } from \"react\";\r\nimport haversine from \"../haversine\";\r\nconst MyShop = () => {\r\n\r\n  const [myShop, setMyShop] = useState({name:\"\", city:\"\", distance:\"\"});\r\n\r\n  useEffect( () =>{\r\n    // requete Ajax\r\n    const url = \"https://formacitron.github.io/shopslist/shops.json\";\r\n    fetch(url)\r\n    .then((response) => response.json())\r\n    .then((shops)=> {\r\n      console.log(shops);\r\n\r\n      navigator.geolocation.getCurrentPosition((position) => {\r\n        const nearest = { distance: null, shop: null}\r\n        console.log(position.coords.latitude, position.coords.longitude);\r\n        for (const shop of shops){\r\n          const a = { latitude: position.coords.latitude, longitude: position.coords.longitude}\r\n            const b = { latitude: shop.gps_lat, longitude: shop.gps_lng }\r\n \r\n            const distance = (haversine(a, b));// 714504.18 (in meters)\r\n            if(nearest.distance == null){\r\n              nearest.distance = distance;\r\n              nearest.shop = shop;\r\n            } else {\r\n              if(nearest.distance > distance){\r\n                nearest.distance = distance;\r\n                nearest.shop = shop;\r\n              }\r\n            }\r\n          }\r\n          setMyShop({name:nearest.shop.name,city:nearest.shop.city , distance:(nearest.distance/1000).toFixed(2)});\r\n        });\r\n    });\r\n  },[]);\r\n  return (\r\n   \r\n    <div className=\"flex flex-col h-full text-center\">\r\n      <h1 className=\"text-2xl text-center\">{myShop.name}</h1>\r\n      <p className=\"flex-grow\">{myShop.city}</p>\r\n      <p>{myShop.distance} km</p>\r\n    </div>\r\n   \r\n  )\r\n}\r\n\r\nexport default MyShop;\r\n"],"mappings":"AACA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,MAAO,CAAAC,SAAS,KAAM,cAAc,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBACrC,KAAM,CAAAC,MAAM,CAAGA,CAAA,GAAM,CAEnB,KAAM,CAACC,MAAM,CAAEC,SAAS,CAAC,CAAGR,QAAQ,CAAC,CAACS,IAAI,CAAC,EAAE,CAAEC,IAAI,CAAC,EAAE,CAAEC,QAAQ,CAAC,EAAE,CAAC,CAAC,CAErEZ,SAAS,CAAE,IAAK,CACd;AACA,KAAM,CAAAa,GAAG,CAAG,oDAAoD,CAChEC,KAAK,CAACD,GAAG,CAAC,CACTE,IAAI,CAAEC,QAAQ,EAAKA,QAAQ,CAACC,IAAI,CAAC,CAAC,CAAC,CACnCF,IAAI,CAAEG,KAAK,EAAI,CACdC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC,CAElBG,SAAS,CAACC,WAAW,CAACC,kBAAkB,CAAEC,QAAQ,EAAK,CACrD,KAAM,CAAAC,OAAO,CAAG,CAAEb,QAAQ,CAAE,IAAI,CAAEc,IAAI,CAAE,IAAI,CAAC,CAC7CP,OAAO,CAACC,GAAG,CAACI,QAAQ,CAACG,MAAM,CAACC,QAAQ,CAAEJ,QAAQ,CAACG,MAAM,CAACE,SAAS,CAAC,CAChE,IAAK,KAAM,CAAAH,IAAI,GAAI,CAAAR,KAAK,CAAC,CACvB,KAAM,CAAAY,CAAC,CAAG,CAAEF,QAAQ,CAAEJ,QAAQ,CAACG,MAAM,CAACC,QAAQ,CAAEC,SAAS,CAAEL,QAAQ,CAACG,MAAM,CAACE,SAAS,CAAC,CACnF,KAAM,CAAAE,CAAC,CAAG,CAAEH,QAAQ,CAAEF,IAAI,CAACM,OAAO,CAAEH,SAAS,CAAEH,IAAI,CAACO,OAAQ,CAAC,CAE7D,KAAM,CAAArB,QAAQ,CAAIV,SAAS,CAAC4B,CAAC,CAAEC,CAAC,CAAE,CAAC;AACnC,GAAGN,OAAO,CAACb,QAAQ,EAAI,IAAI,CAAC,CAC1Ba,OAAO,CAACb,QAAQ,CAAGA,QAAQ,CAC3Ba,OAAO,CAACC,IAAI,CAAGA,IAAI,CACrB,CAAC,IAAM,CACL,GAAGD,OAAO,CAACb,QAAQ,CAAGA,QAAQ,CAAC,CAC7Ba,OAAO,CAACb,QAAQ,CAAGA,QAAQ,CAC3Ba,OAAO,CAACC,IAAI,CAAGA,IAAI,CACrB,CACF,CACF,CACAjB,SAAS,CAAC,CAACC,IAAI,CAACe,OAAO,CAACC,IAAI,CAAChB,IAAI,CAACC,IAAI,CAACc,OAAO,CAACC,IAAI,CAACf,IAAI,CAAGC,QAAQ,CAAC,CAACa,OAAO,CAACb,QAAQ,CAAC,IAAI,EAAEsB,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAC1G,CAAC,CAAC,CACN,CAAC,CAAC,CACJ,CAAC,CAAC,EAAE,CAAC,CACL,mBAEE5B,KAAA,QAAK6B,SAAS,CAAC,kCAAkC,CAAAC,QAAA,eAC/ChC,IAAA,OAAI+B,SAAS,CAAC,sBAAsB,CAAAC,QAAA,CAAE5B,MAAM,CAACE,IAAI,CAAK,CAAC,cACvDN,IAAA,MAAG+B,SAAS,CAAC,WAAW,CAAAC,QAAA,CAAE5B,MAAM,CAACG,IAAI,CAAI,CAAC,cAC1CL,KAAA,MAAA8B,QAAA,EAAI5B,MAAM,CAACI,QAAQ,CAAC,KAAG,EAAG,CAAC,EACxB,CAAC,CAGV,CAAC,CAED,cAAe,CAAAL,MAAM"},"metadata":{},"sourceType":"module","externalDependencies":[]}